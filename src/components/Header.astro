---
import { Icon } from "astro-icon/components";

const baseUrl = import.meta.env.BASE_URL;
const withBase = (path: string) => `${baseUrl.replace(/\/$/, "")}/${path.replace(/^\//, "")}`;
const basePath = baseUrl.replace(/\/$/, "");
const currentPath = Astro.url.pathname.replace(basePath, "") || "/";

const navItems = [
  { href: withBase("/"), label: "Главная", path: "/" },
  { href: withBase("/kristina"), label: "Дементьева Кристина", path: "/kristina" },
  { href: withBase("/roman"), label: "Жданов Роман", path: "/roman" },
  { href: withBase("/contact"), label: "Контакты", path: "/contact" }
];
---
<header class="sticky top-0 z-50 w-full border-b border-stroke/60 bg-bg/85 backdrop-blur">
  <div class="container-tight flex items-center justify-between py-4">
    <a href={withBase("/")} class="text-lg font-semibold tracking-tight focus-ring">
      Окей Кристи Production
    </a>
    <nav class="hidden items-center gap-6 text-sm font-medium text-muted lg:flex">
      {navItems.map((item) => {
        const isActive = currentPath === item.path;
        return (
          <a
            class={`transition-colors focus-ring ${isActive ? "nav-link-active" : "hover:text-text"}`}
            href={item.href}
            aria-current={isActive ? "page" : undefined}
          >
            {item.label}
          </a>
        );
      })}
    </nav>
    <button
      class="lg:hidden flex h-11 w-11 items-center justify-center rounded-full border border-stroke/70 focus-ring"
      aria-label="Открыть меню"
      data-menu-toggle
      type="button"
    >
      <Icon name="lucide:menu" class="h-5 w-5" aria-hidden="true" />
    </button>
  </div>
  <div
    class="fixed inset-0 z-40 hidden bg-bg/95 backdrop-blur"
    data-menu-overlay
  >
    <div class="container-tight flex h-full flex-col gap-6 py-10" data-menu-content>
      <div class="flex items-center justify-between">
        <span class="text-lg font-semibold">Меню</span>
        <button
          class="flex h-11 w-11 items-center justify-center rounded-full border border-stroke/70 focus-ring"
          aria-label="Закрыть меню"
          data-menu-close
          type="button"
        >
          <Icon name="lucide:x" class="h-5 w-5" aria-hidden="true" />
        </button>
      </div>
      <nav class="flex flex-col gap-4 text-base font-medium">
        {navItems.map((item) => {
          const isActive = currentPath === item.path;
          return (
            <a
              class={`focus-ring ${isActive ? "text-text" : ""}`}
              href={item.href}
              data-menu-link
              aria-current={isActive ? "page" : undefined}
            >
              {item.label}
            </a>
          );
        })}
      </nav>
    </div>
  </div>
</header>
